<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include("partials/head") %>
  </head>
  <body>
    <header><%- include("partials/header") %></header>

    <div class="container mt-5 mb-3 mx-auto w-auto">
      <div>
        <% if(user) {%>
        <h3>Hello, <%= user.username %></h3>
        <p>Welcome to your Yásè dashboard</p>
        <% }%>
        <div>
          <a class="btn btn-primary" href="/views/todo/create">Add Task</a>

          <div class="input-group mt-3 mb-3" style="width: max-content">
            <div class="input-group-prepend">
              <label class="input-group-text" for="statusFilter">Status</label>
            </div>
            <select class="form-select" id="statusFilter">
              <option value="all">All</option>
              <option value="completed">Completed</option>
              <option value="pending">Pending</option>
            </select>
          </div>
        </div>
      </div>
      <table class="table table-striped table-responsive">
        <thead>
          <tr>
            <th scope="col">Task title</th>
            <th scope="col">Description</th>
            <th scope="col">Status</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>

        <tbody>
          <% tasks.forEach(function(task){ %>
          <tr>
            <td><%= task.title %></td>
            <td><%= task.description %></td>
            <td><%= task.status %></td>
            <td>
              <div class="row">
                <form
                  class="col"
                  action="/views/todo/<%= task._id %>"
                  method="PUT"
                >
                  <input type="hidden" value="finished" name="update" />
                  <button class="btn btn-success" formmethod="post">
                    Finish
                  </button>
                </form>

                <form
                  class="col"
                  action="/views/todo/<%= task._id %>"
                  method="POST"
                >
                  <input type="hidden" value="delete" name="delete" />
                  <button class="btn btn-danger" formmethod="post">
                    Delete
                  </button>
                </form>
              </div>
            </td>
          </tr>

          <%})%>
        </tbody>
      </table>
    </div>
  </body>
</html>
